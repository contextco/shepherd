#!/usr/bin/env ruby

require File.expand_path('../config/environment', __dir__)

# Require generated protobuf files using full paths
$LOAD_PATH.unshift(File.expand_path('gen', Rails.root))

require 'service_pb'
require 'service_services_pb'

# Require all service files
Dir[Rails.root.join('app/rpc/*.rb')].sort.each { |f| puts f; require f }

server = Gruf::Server.new
server.add_service(OnPrem::Service)
# server.add_service(TestThing)
server.start!
